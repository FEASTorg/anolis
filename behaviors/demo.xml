<?xml version="1.0"?>
<root BTCPP_format="4">
    <!-- 
     Demo Behavior Tree
    
    This BT demonstrates basic automation with anolis-provider-sim:
    1. Check tempctl0 temperature quality
    2. Ramp through multiple temperature setpoints using JSON args
    3. If STALE/FAULT, log and halt
    
    Device: tempctl0 (simulated temperature controller)
    Signals: tc1_temp, tc2_temp (thermocouple readings)
    Functions: set_setpoint(value: double)
    
    Args format: JSON object string, e.g., '{"target":30.0}'
    Validation: Handled by CallRouter using ArgSpec metadata
    
    -->

    <BehaviorTree ID="TempRampSequence">
        <Sequence>
            <!-- Check if temperature signal is available and OK quality -->
            <CheckQuality
                device_handle="sim0/tempctl0"
                signal_id="tc1_temp"
                expected_quality="OK"
                name="VerifyTempSensorQuality" />

            <!-- Ramp to 25C -->
            <Sequence>
                <CallDevice
                    device_handle="sim0/tempctl0"
                    function_name="set_setpoint"
                    args='json:{"value":25.0}'
                    success="{call_success}"
                    error="{call_error}"
                    name="SetTargetTemp25C" />

                <ReadSignal
                    device_handle="sim0/tempctl0"
                    signal_id="tc1_temp"
                    value="{current_temp}"
                    quality="{temp_quality}"
                    name="ReadCurrentTemp25" />
            </Sequence>

            <!-- Ramp to 30C -->
            <Sequence>
                <CallDevice
                    device_handle="sim0/tempctl0"
                    function_name="set_setpoint"
                    args='json:{"value":30.0}'
                    success="{call_success}"
                    error="{call_error}"
                    name="SetTargetTemp30C" />

                <ReadSignal
                    device_handle="sim0/tempctl0"
                    signal_id="tc1_temp"
                    value="{current_temp}"
                    quality="{temp_quality}"
                    name="ReadCurrentTemp30" />
            </Sequence>
        </Sequence>
    </BehaviorTree>
</root>

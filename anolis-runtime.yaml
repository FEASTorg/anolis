# Anolis Runtime Configuration
# HTTP Gateway + Basic provider config

runtime:
  mode: MANUAL # MANUAL | AUTO | IDLE | FAULT

http:
  enabled: true
  bind: 127.0.0.1
  port: 8080
  cors_allowed_origins:
    - http://localhost:3000
    - http://127.0.0.1:3000
  cors_allow_credentials: false
  # thread_pool_size: 40

providers:
  - id: sim0
    # Portable relative path (adjust based on your build configuration)
    # Windows Release: ../anolis-provider-sim/build/Release/anolis-provider-sim.exe
    # Windows Debug:   ../anolis-provider-sim/build/Debug/anolis-provider-sim.exe
    # Linux/macOS:     ../anolis-provider-sim/build/anolis-provider-sim
    command: ../anolis-provider-sim/build/Release/anolis-provider-sim
    args: []
    timeout_ms: 5000
    # restart_policy:
    #   enabled: true
    #   max_attempts: 3
    #   backoff_ms: [200, 500, 1000]
    #   timeout_ms: 30000

polling:
  interval_ms: 500 # Default polling interval (min 100ms)

telemetry:
  enabled: true
  influxdb:
    url: http://localhost:8086
    org: anolis
    bucket: anolis
    token: dev-token
    batch_size: 100
    flush_interval_ms: 1000

automation:
  enabled: true # Set to true to enable behavior tree automation
  behavior_tree: ./behaviors/demo.xml
  tick_rate_hz: 10 # 1-1000 Hz
  manual_gating_policy: BLOCK # BLOCK or OVERRIDE

  # Runtime parameters
  parameters:
    - name: temp_setpoint
      type: double
      default: 25.0
      min: 10.0
      max: 50.0

    - name: motor_duty_cycle
      type: int64
      default: 50
      min: 0
      max: 100

    - name: control_enabled
      type: bool
      default: true

    - name: operating_mode
      type: string
      default: "normal"
      allowed_values: ["normal", "test", "emergency"]

logging:
  level: info # debug, info, warn, error
